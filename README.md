# Project Overview

This project involves developing a robust image processing and machine learning pipeline for age classification using a dataset of face images. The system design includes several scripts and configurations to handle data loading, preprocessing, quality checking, augmentation, visualization, and model training. The key components and their functionalities are described below.

##  System Design

- `utils.py`: Contains utility functions that are commonly used across multiple scripts.

- `explore_images.py`: Main script for loading the dataset, computing image quality metrics, checking image quality, and generating a CSV file with metadata.

- `image_reader.py`: Provides functions to load images, compute image quality metrics, and check image quality based on predefined thresholds.

- `image_processor.py`: Includes functions for processing images, such as sharpening, denoising, brightening, and enhancing texture. Also contains functions to ensure the processed images meet quality standards.

- `process_images.py`: Script to apply image processing functions to the dataset and save the processed images.

- `image_visualizer.py`: Provides functions for visualizing distributions of image quality metrics and saving the visualizations.

- `visualize_image_information.py`: Main script to visualize image quality metrics using the functions in `image_visualizer.py`. Generates plots for various metrics and saves them to specified directories.

- `australian_population.ipynb`: Jupyter notebook for analyzing Australian population distribution. Used to create a target distribution for resampling the dataset to match age demographics.

- `resampling.ipynb`: Jupyter notebook for resampling the dataset based on the target age distribution. Performs both up-sampling and down-sampling to achieve the desired distribution.

- `train_model.py`: Script to train a deep learning model for age classification. Includes data loading, model definition, training loop, and evaluation metrics.

### Configuration Files

The configuration files are stored in the configs directory. They specify various parameters for different scripts, such as paths to datasets, thresholds for quality metrics, and settings for data augmentation and model training.
Directories

- csv: Contains CSV files with metadata generated by explore_images.py.

- processed_dataset: Directory where processed images are saved after applying image quality checks and enhancements.

- resampled_dataset: Directory where resampled images are saved to match the target age distribution.

### Detailed Component Descriptions

#### utils.py

- Contains utility functions for tasks such as reading configuration files, logging, and common data processing steps.

#### explore_images.py

- Reads a configuration file for parameters.
- Loads images from the dataset directory.
- Computes image quality metrics such as blurriness, noise, brightness, and resolution.
- Checks the quality of images based on defined thresholds.
- Generates a CSV file with metadata for all images.

#### image_reader.py

- load_dataset: Loads images and their corresponding age labels.
- compute_images_quality_metrics: Computes quality metrics for each image.
- check_images_quality: Checks image quality and flags low-quality images.

#### image_processor.py

- Functions to process images (e.g., sharpening, denoising, brightening).
- Ensures processed images meet quality standards.

#### process_images.py

- Applies image processing functions to the dataset.
- Saves processed images to the processed_dataset directory.

#### image_visualizer.py

- visualize_distribution: Creates histograms for various image quality metrics and saves the plots.

#### visualize_image_information.py

- Uses image_visualizer.py functions to generate and save plots for image quality metrics.
- Reads metadata from a CSV file and creates visualizations.

#### australian_population.ipynb

- Analyzes Australian population distribution to create a target age distribution for resampling the dataset.

#### resampling.ipynb

- Performs resampling of the dataset to match the target age distribution.
- Uses both up-sampling (data augmentation) and down-sampling techniques.

#### train_model.py

- Loads the dataset and splits it into training and validation sets.
- Defines the age classification model.
- Trains the model and evaluates its performance.
- Saves the trained model.
