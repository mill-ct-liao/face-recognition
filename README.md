# Project Overview

This project involves developing a robust image processing and machine learning pipeline for age classification using a dataset of face images. The system design includes several scripts and configurations to handle data loading, preprocessing, quality checking, augmentation, visualization, and model training. The key components and their functionalities are described below.

##  System Design

- `utils.py`: Contains utility functions that are commonly used across multiple scripts.

- `explore_images.py`: Main script for loading the dataset, computing image quality metrics, checking image quality, and generating a CSV file with metadata.

- `image_reader.py`: Provides functions to load images, compute image quality metrics, and check image quality based on predefined thresholds.

- `image_processor.py`: Includes functions for processing images, such as sharpening, denoising, brightening, and enhancing texture. Also contains functions to ensure the processed images meet quality standards.

- `process_images.py`: Script to apply image processing functions to the dataset and save the processed images.

- `image_visualizer.py`: Provides functions for visualizing distributions of image quality metrics and saving the visualizations.

- `visualize_image_information.py`: Main script to visualize image quality metrics using the functions in `image_visualizer.py`. Generates plots for various metrics and saves them to specified directories.

- `australian_population.ipynb`: Jupyter notebook for analyzing Australian population distribution. Used to create a target distribution for resampling the dataset to match age demographics.

- `resampling.ipynb`: Jupyter notebook for resampling the dataset based on the target age distribution. Performs both up-sampling and down-sampling to achieve the desired distribution.

- `train_model.py`: Script to train a deep learning model for age classification. Includes data loading, model definition, training loop, and evaluation metrics.

### Configuration Files

The configuration files are stored in the configs directory. They specify various parameters for different scripts, such as paths to datasets, thresholds for quality metrics, and settings for data augmentation and model training.
Directories

- csv: Contains CSV files with metadata generated by explore_images.py.

- processed_dataset: Directory where processed images are saved after applying image quality checks and enhancements.

- resampled_dataset: Directory where resampled images are saved to match the target age distribution.

### Detailed Component Descriptions

#### `utils.py`

- Contains utility functions for tasks such as reading configuration files, logging, and common data processing steps.

#### `explore_images.py`

- Reads a configuration file for parameters.
- Loads images from the dataset directory.
- Computes image quality metrics such as blurriness, noise, brightness, and resolution.
- Checks the quality of images based on defined thresholds.
- Generates a CSV file with metadata for all images.

#### `image_reader.py`

- load_dataset: Loads images and their corresponding age labels.
- compute_images_quality_metrics: Computes quality metrics for each image.
- check_images_quality: Checks image quality and flags low-quality images.

#### `image_processor.py`

- Functions to process images (e.g., sharpening, denoising, brightening).
- Ensures processed images meet quality standards.

#### `process_images.py`

- Applies image processing functions to the dataset.
- Saves processed images to the processed_dataset directory.

#### `image_visualizer.py`

- visualize_distribution: Creates histograms for various image quality metrics and saves the plots.

#### `visualize_image_information.py`

- Uses `image_visualizer.py` functions to generate and save plots for image quality metrics.
- Reads metadata from a CSV file and creates visualizations.

#### `australian_population.ipynb`

- Analyzes Australian population distribution to create a target age distribution for resampling the dataset.

#### `resampling.ipynb`

- Performs resampling of the dataset to match the target age distribution.
- Uses both up-sampling (data augmentation) and down-sampling techniques.

#### `train_model.py`

- Loads the dataset and splits it into training and validation sets.
- Defines the age classification model.
- Trains the model and evaluates its performance.
- Saves the trained model.

## Data Analysis

### 1. Age Distribution

![image](visualizations/original_image/age_distribution.png)

This histogram represents the distribution of images across different ages. Here's an explanation of the key points:

- X-axis (Age): The x-axis shows the age groups, ranging from 20 to 50 years.
- Y-axis (Number of Images): The y-axis shows the number of images corresponding to each age group.
- Insight: This histogram shows the distribution of the number of images across different age groups in the dataset. The dataset includes images labeled with ages ranging from 20 to 50. There is a noticeable peak around the age of 25 and a lower count of images in the higher age ranges like 45-50.

### 2. Laplacian Variance Distribution

![image](visualizations/original_image/laplacian_variance_distribution.png)

- X-axis: Laplacian Variance
- Y-axis: Number of Images
- Insight: This histogram shows the distribution of the Laplacian variance values, which measure the sharpness of the images. A low variance indicates a blurry image. Most images have a low Laplacian variance, suggesting that there are many blurry images in the dataset.

### 3. Mean Intensity Distribution

![image](visualizations/original_image/mean_intensity_distribution.png)

- X-axis: Mean Intensity
- Y-axis: Number of Images
- Insight: This histogram shows the distribution of the mean intensity values of the images. The mean intensity is a measure of the overall brightness of an image. Most images have a mean intensity between 50 and 150, suggesting that the dataset contains images with a wide range of lighting conditions.

### 4. Standard Deviation Distribution

![image](visualizations/original_image/standard_deviation_distribution.png)

- X-axis: Standard Deviation
- Y-axis: Number of Images
- Insight: This histogram shows the distribution of the standard deviation of pixel intensities in the images. The standard deviation is a measure of the noise or texture in an image. Most images have a standard deviation between 40 and 80, indicating moderate noise levels.

### Image Quality Metrics

#### 1. Blurry Images

Blurriness can be quantified using the variance of the Laplacian. The Laplacian operator highlights regions of rapid intensity change, and its variance is a measure of how much the intensity changes in the image.

**Mathematical Definition:**
- **Laplacian:** The Laplacian is a second-order derivative operator that computes the sum of second-order derivatives in both the x and y directions.
- **Variance of the Laplacian:** The variance of the Laplacian measures the spread of pixel intensity values after applying the Laplacian operator. Lower variance indicates less sharpness (i.e., more blurriness).

#### 2. Noisy Images

Noise in images can be quantified using the standard deviation of pixel intensity values. High noise levels usually lead to higher standard deviation due to the random fluctuations in pixel values.

**Mathematical Definition:**
- **Standard Deviation:** Measures the amount of variation or dispersion of a set of values. Higher standard deviation indicates higher noise.

#### 3. Low Resolution

The number of pixels in the horizontal and vertical dimensions of the image.

#### 4. Poor Lighting

Poor lighting can be quantified using the mean intensity of the image. Images that are too dark or too bright will have mean intensity values close to 0 or 255, respectively.

**Thresholds for Image Quality Metrics:**
- **Laplacian Variance (Blurriness):**
  - Too Low: $< 100$ (indicates significant blurriness)
  - Too High: $> 1000$ (generally not an issue unless excessively high due to noise)
- **Mean Intensity (Brightness):**
  - Too Low: $< 50$ (indicates the image is too dark)
  - Too High: $> 200$ (indicates the image is too bright)
- **Standard Deviation (Noise):**
  - Too Low: $< 10$ (indicates lack of texture or overly smooth images)
  - Too High: $> 100$ (indicates significant noise)
- **Resolution:**
  - Typically, images with resolution less than a certain threshold (e.g., $100 \times 100$ pixels) are considered low resolution.
## Image Processing

### 1. Too Blurry

Technique: Sharpening

- Unsharp Masking: Enhances the edges in the image by subtracting a blurred version of the image from the original image.
- High-Pass Filtering: Emphasizes high-frequency components (edges) in the image.

### 2. Too Noisy (High Laplacian Variance or High Standard Deviation)

Technique: Denoising

- Gaussian Blur: Reduces image noise and detail by applying a Gaussian filter.
- Median Filtering: Reduces salt-and-pepper noise by replacing each pixel with the median value in its neighborhood.
- Bilateral Filtering: Reduces noise while preserving edges.
    
### 3. Too Dark & Too Bright

Technique: Brightness Adjustment

- Histogram Equalization: Enhances the contrast of images by spreading out the most frequent intensity values.
- Gamma Correction: Adjusts the brightness by applying a gamma value to the pixel values.
    
    
### 4. Lack of Texture

Technique: Texture Enhancement

- High-Pass Filtering: Enhances textures and edges by removing low-frequency components.
- Histogram Equalization: Enhances the contrast and can bring out textures.
    
### 5. Low Resolution

Technique: Super-Resolution

- Super-Resolution Techniques: Enhance the resolution of an image using machine learning models or interpolation methods.
- Interpolation: Methods like bilinear or bicubic interpolation to increase image size.
